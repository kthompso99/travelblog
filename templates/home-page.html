<div id="home-view">
    <div class="hero">
        <h1>{{SITE_TITLE}}</h1>
        <p>{{SITE_DESCRIPTION}}</p>
    </div>

    <h2 style="margin-bottom: 1rem;">Featured Trips</h2>
    <div class="destination-grid" id="destination-grid">
        {{TRIP_GRID}}
    </div>
</div>

<script>
    // SPA enhancement for homepage
    let config = null;
    const tripContentCache = {};
    let map = null;
    let markers = [];

    const APP_BASE = '{{APP_BASE}}';
    const BASE_PATH = './';

    async function loadConfig() {
        try {
            const response = await fetch(APP_BASE + 'config.built.json');
            config = await response.json();
        } catch (error) {
            console.log('Config not loaded, static mode only');
        }
    }

    // Load trip with SPA navigation
    async function loadTrip(id, pushState = true) {
        if (!config) {
            // Fallback to static navigation
            window.location.href = `${APP_BASE}trips/${id}/`;
            return;
        }

        const tripMetadata = config.trips.find(d => d.id === id);
        if (!tripMetadata) {
            window.location.href = `${APP_BASE}trips/${id}/`;
            return;
        }

        if (pushState) {
            history.pushState({ view: 'trip', id: id }, tripMetadata.title, `${APP_BASE}trips/${id}/`);
        }

        // Check cache first
        if (tripContentCache[id]) {
            navigateToTrip(id);
            return;
        }

        // For now, do full page navigation to static page
        // Full SPA implementation can be added later
        window.location.href = `${APP_BASE}trips/${id}/`;
    }

    function navigateToTrip(id) {
        window.location.href = `${APP_BASE}trips/${id}/`;
    }

    // Intercept clicks on trip cards
    document.addEventListener('DOMContentLoaded', () => {
        loadConfig();

        // Add click handlers to trip cards if they don't have href
        document.querySelectorAll('[data-trip-id]').forEach(card => {
            card.addEventListener('click', (e) => {
                e.preventDefault();
                const tripId = card.getAttribute('data-trip-id');
                loadTrip(tripId);
            });
        });
    });
</script>
